{% extends 'base.html' %} {% block title %} ë©”ì¸ í˜ì´ì§€ - Jungle Helper {%
endblock %} {% block extra_css %}
<link
  rel="stylesheet"
  href="{{ url_for('static', filename='css/listStyle.css') }}"
/>
{% endblock %} {% block content %}
<div class="list-wrp">
  <!-- âœ… ê¸€ì“°ê¸° ë²„íŠ¼ -->
  <div class="write-btn-wrap">
    <a href="{{ url_for('create_post_page') }}">
      <button class="write-btn">ê²Œì‹œê¸€ ì‘ì„±</button>
    </a>
  </div>

  <!-- âœ… ê²Œì‹œê¸€ ì¹´ë“œ ëª©ë¡ -->
  <div class="card-grid">
    {% for post in posts %}
    <a
      href="{{ url_for('get_post_detail', post_id=post.id) }}"
      class="card-link"
    >
      <div class="card">
        <img src="{{ post.image_url }}" alt="ëŒ€í‘œ ì´ë¯¸ì§€" />
        <div class="card-body">
          <div class="badges">
            <div>
              <span
                class="badge category {% if post.category == 'ë‚˜ëˆ”í•´ìš”' %}give{% elif post.category == 'í•„ìš”í•´ìš”' %}take{% endif %}"
              >
                {{ post.category }}
              </span>
              <span
                class="badge status {{ 'ongoing' if post.status else 'done' }}"
              >
                {{ 'ing' if post.status else 'done' }}
              </span>
            </div>
          </div>
          <div class="card-title-wrp">
            <h3 class="card-title">{{ post.title }}</h3>
            <p class="price">{{ post.price }}</p>
          </div>
          <div class="meta">
            <span class="author">{{ post.nick_name }}</span>
            <span class="date">{{ post.created_at }}</span>
          </div>
        </div>
      </div>
    </a>
    {% endfor %}
  </div>
  <p class="post-count">ì´ {{ total_count }}ê°œì˜ ê²Œì‹œê¸€ì´ ìˆìŠµë‹ˆë‹¤.</p>

  <!-- âœ… í˜ì´ì§€ë„¤ì´ì…˜ -->
  <div class="pagination">
    {% set POSTS_PER_PAGE = 12 %} {% set PAGES_PER_GROUP = 5 %} {% set
    total_pages = (total_count // POSTS_PER_PAGE) + (1 if total_count %
    POSTS_PER_PAGE else 0) %} {# âš ï¸ í˜ì´ì§€ íŒŒë¼ë¯¸í„°ê°€ ì—†ê±°ë‚˜ ì˜ëª»ëœ ê°’ì´ë©´ 1ë¡œ
    ê¸°ë³¸ ì„¤ì • #} {% set raw_page = request.args.get('page', '1') %} {% set
    current_page = raw_page.isdigit() and raw_page | int or 1 %} {# ğŸ” ìµœì†Œ
    1í˜ì´ì§€ë¡œ ë³´ì¥ #} {% if current_page < 1 %} {% set current_page = 1 %} {%
    endif %} {% set current_group = (current_page - 1) // PAGES_PER_GROUP %} {%
    set start_page = current_group * PAGES_PER_GROUP + 1 %} {% set end_page =
    [start_page + PAGES_PER_GROUP - 1, total_pages] | min %} {# â—€ ì´ì „ ê·¸ë£¹ ë²„íŠ¼
    #} {% if start_page > 1 %}
    <a
      href="{{ url_for('main_page', category=current_category, page=start_page - 1) }}"
      class="page-btn"
      >â®</a
    >
    {% endif %} {# í˜ì´ì§€ ë²ˆí˜¸ë“¤ #} {% for p in range(start_page, end_page + 1)
    %}
    <a
      href="{{ url_for('main_page', category=current_category, page=p) }}"
      class="page-btn {% if p == current_page %}active{% endif %}"
      >{{ p }}</a
    >
    {% endfor %} {# â–¶ ë‹¤ìŒ ê·¸ë£¹ ë²„íŠ¼ #} {% if end_page < total_pages %}
    <a
      href="{{ url_for('main_page', category=current_category, page=end_page + 1) }}"
      class="page-btn"
      >â¯</a
    >
    {% endif %}
  </div>
</div>
{% endblock %}
